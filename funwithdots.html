<html>
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8">
		<title>Getting started with Canvas</title>
		<script type="text/javascript" charset="utf-8">			
						var dots = [];
			function draw() {
				var canvas = document.getElementById("getting_started");
				var ctx = canvas.getContext("2d");

				function Dot(ctx) {
					this.x = Math.floor( Math.random() * 400 );
					this.y = Math.floor( Math.random() * 400 );
					this.ctx = ctx;
				}
				Dot.prototype.draw = function() {
					this.ctx.fillRect(this.x, this.y, 2, 2);
				}
				Dot.prototype.distance = function(dot) { 
					return Math.sqrt( Math.pow(this.x - dot.x, 2) + Math.pow(this.y - dot.y, 2) );
				}
				Dot.prototype.draw_closest = function(dots) {
					for( var index in dots ) {
						var dot = dots[index];
						var dist = this.distance( dot );
						
						var cutoff = 50;
						if( (dist > 0) && (dist < cutoff) ) {
							var alpha = Math.round( (dist / cutoff) * 10 ) / 30; 
							this.ctx.beginPath();
							this.ctx.strokeStyle = "rgba(0,0,0," + alpha + ")";
							this.ctx.moveTo(this.x, this.y);
							this.ctx.lineTo(dot.x, dot.y);
							this.ctx.stroke();
						}
					}
				}
				
				for( var i = 0; i < 100; i++ ) {
					var d = new Dot(ctx);
					dots.push(d);
				}


				var frame = 0;
				var frameInterval = setInterval(function() {
					frame += 1;
					if( frame > 50 ) { stopInterval(frameInterval); }
					console.log("Frame", frame);
					
					ctx.beginPath();
					
					//clear screen
					ctx.fillStyle = "rgb(255,255,255)";
					ctx.fillRect(0,0,400,400);
					
					//re-draw dots
					for( var index in dots ) {
						var d = dots[index];
						d.draw();
						d.draw_closest(dots);
					}
					ctx.stroke();
					
				}, 1200);
			}
		</script>
		<style type="text/css" media="screen">
			#getting_started {
				border: 1px solid black;
			}
		</style>
	</head>
	<body id="basics" onload="draw();">
		<canvas id="getting_started" width="400" height="400"></canvas>
	</body>
</html>